clear all
close all
clc

s = tf('s');
s = 1e-4

c11 = (0.105)/(83*s + 1)*exp(-65*s);
c12 = (-0.082)/(1766*s + 1)*exp(-80*s);
c13 = (-0.0575)/(176*s + 1)*exp(-460*s);

c21 = (-0.0468)/(1864*s + 1)*exp(-140*s);
c22 = (0.000122)/(s);
c23 = (0.115)/(1981*s + 1)*exp(-120*s);

c31 = (0.00253)/(s);
c32 = 0;
c33 = (-0.00299)/(s);


%%%%%%%%%%%%%%% SISTEMA C(0) %%%%%%%%%%%%%%%%%%%
C.coef = [0.1034600 -0.069137 -0.053965;
          -0.038899 1.2200000 0.0948400;
          25.300000 0.0000000 -29.90000];

%%%%%%%%%%%%%% Inversa de "C(0)" %%%%%%%%%%%%%%%%
C.inv = inv(C.coef);

%%%%%%%%%%%%%% Diagonal de "C" %%%%%%%%%%%%%%%%    
% Obtida a partir de C fazendo s = 1e-8;
T.sys = [0.105 0.000 0.0000000;
         0.000 12200 0.0000000;
         0.000 0.000 -2.99e+05];
%%%%%%%%%%%%%%% Sistema CRAIG  %%%%%%%%%%%%%%%%
C.sys = [c11 c12 c13;
         c21 c22 c23;
         c31 c32 c33];

%%%%%%%%%%%%%%   Desacoplador Estático  %%%%%%%%%%
D.sta = C.inv*T.sys;

%%%%%%%%%%%%%% Sistemas Desacoplados  %%%%%%%%%%%%%
T.sta = C.sys*D.sta;